<div align="center">

#  **FAIRTURN**
  
  ![Badge Language Count](https://img.shields.io/github/languages/count/artaka/Fairturn)
  ![Badge Language](https://img.shields.io/github/languages/top/artaka/Fairturn)
  ![GitHub stars](https://img.shields.io/github/stars/artaka/Fairturn?style=social)


  <br>

  <a id="link-wiki" href="https://github.com/artaka/Fairturn/blob/master/techDocumentation.docx">📘 Исследуйте документацию</a>
  <br>

**[<kbd> <br> Описание <br> </kbd>](#описание)**&nbsp;&nbsp;
**[<kbd> <br> Установка и использование <br> </kbd>](#установка-и-использование)**&nbsp;&nbsp;
**[<kbd> <br> Архитектура проекта <br> </kbd>](#архитектура-проекта)**&nbsp;&nbsp;
**[<kbd> <br>Лицензия <br> </kbd>](#лицензия)**&nbsp;&nbsp;

  <br>
</div>


> [!CAUTION]
> Проект находится в стадии разработки и предназначен для образовательных целей.
>
---

> [New]
> Проект был полностью переписан на Python.
>
---

# Описание

**Fairturn** — это приложение, созданное для справедливого распределения очередности сдачи лабораторных работ. Оно устраняет субъективность при распределении приоритетов, предоставляя возможность автоматического управления очередью на основе объективных критериев.  

Приложение идеально подходит для преподавателей и студентов, помогая сделать процесс сдачи лабораторных работ максимально прозрачным и удобным.  
Для использования нашей программы:
- Один из участников группы или подгруппы создает веб-таблицу в Google Таблицах и предоставляет доступ для редактирования всем, у кого есть ссылка.
- Все члены группы заполняют таблицу своими данными.
- После заполнения таблицы ответственный участник запускает Fairturn.exe.
- Программа автоматически обработает данные и сформирует окончательный список.

Посмотрите, как работает программа: [Видео работы программы.](https://disk.yandex.ru/i/uVZv_Vv1GRrf1w)

Посмотрите, как работает обновлённая версия программы: [Видео работы программы.](https://disk.yandex.ru/i/6i-_3fhK1FvElA)


Инструкции по установке и использованию приведены ниже.

### Основные цели
- Упрощение процесса сдачи лабораторных работ.  
- Обеспечение равенства участников.  
- Исключение субъективных факторов при определении очередности.  

### Основные функции

- **Импорт данных** из веб-таблиц для автоматизации ввода.  
- **Ручной ввод данных** для более гибкого управления.  
- **Сортировка участников** по количеству выполненных лабораторных работ.  
- **Чтение и запись данных** в файлы для удобного хранения и обмена.  
- **Интеграция с Google Sheets** через Python-скрипты.  
- **Простое меню** для быстрого доступа к функциональности.  
- **Учет текущей лабораторной работы** *(новое)* — теперь при запуске необходимо указать номер текущей лабораторной.  
  - Если сдаваемая лабораторная совпадает с текущей, у участника **снимается 10 баллов**, что значительно поднимает его в рейтинге. Кто не успел, тот опоздал!
---
# Установка и использование
1. **Скачайте релиз**:
   - Загрузите последнюю версию архива из раздела [GitHub Releases](https://github.com/artaka/Fairturn/releases)
2. **Распакуйте файлы**:
   - Распакуйте архив в удобную директорию.
### Получение токена ###
### Шаг 1. Создание проекта в Google Cloud Console

1. Перейдите на [Google Cloud Console](https://console.cloud.google.com/).
2. Войдите в свою Google учётную запись.
3. Создайте новый проект:
   - Нажмите **New Project**.
   - Укажите название проекта (например, "My Desktop App").
   - Нажмите **Create**.
   - [Посмотреть фото_1](https://postimg.cc/qhHMrYYs)
   - [Посмотреть фото_2](https://postimg.cc/vDSk69Yj)


### Шаг 2. Включение необходимых API

1. Перейдите в раздел **APIs & Services** → **Library**.
2. Найдите и включите нужные API:
   - **Google Sheets API**.
   - Нажмите **Enable** для каждого API.
 - [Посмотреть фото](https://postimg.cc/tZ4vsRLp)
### Шаг 3. Настройка экрана согласия (OAuth Consent Screen)

1. Перейдите в **APIs & Services** → **OAuth consent screen**.
2. Настройте параметры:
   - **User Type**: Выберите `External`.
   - Укажите:
     - **Application Name**: Имя вашего приложения.
     - **Email**: User support email и Developer contact information.
     - **Test users**: когда вы будете на 3 шаги добавьте свою почту в Test users
3. Нажмите **Save and Continue**.
### Шаг 4. Создание OAuth Client ID

1. Перейдите в **APIs & Services** → **Credentials**.
2. Нажмите **Create Credentials** → **OAuth client ID**.
3. Укажите:
   - **Application Type**: Выберите `Desktop Application`.
   - Дайте приложению имя (например, "My Desktop App").
4. Нажмите **Create**.
5. Скачайте файл `credentials.json`:
   - После создания клиента появится окно с данными.
   - Нажмите **Download JSON**.
   - Сохраните файл в папку приложения(которая находится в Releases) и переименуйте его в `credentials.json`. Должна получится структура, как на фото.
   - [Посмотреть фото](https://postimg.cc/F1fG86vW)
### Шаг 5. Настройка консольного приложения
1. Запустите файл `forpython.bat` и следуйте инструкциям в окне. Этот файл проверит:
   - Установку Python.
   - Установку всех необходимых библиотек.
2. После завершения можно запускать проект `fairturn.exe`.
   - Выберите пункт 1. Process table from Google Sheets
3. Вас перекинет на страницу Google, где:
   - Выберите аккаунт, с которым создавался токен.
   - Предоставьте доступ приложению.
- Если у вас появилась в google надпись `The authentication flow has completed. You may close this window.` - значит всё прошло успешно и в директорию проекта добавился файл `token.pickle`
- После этого у вас должно появиться поля для ввода Spreadsheet ID. Вам необходимо нажать сочетание клавиш Ctrl+C
### Шаг 6. Работа с приложением
1. Запустите `Fairturn.exe`.
2. Пользуйтесь приложением! 🎉
---
# Архитектура проекта

Проект состоит из нескольких независимых модулей, что позволяет легко изменять или добавлять новый функционал.  

### Основные модули
- **parserIN**: Извлечение данных из веб-таблиц.  
- **parserOUT**: Запись данных из файла в веб-таблицу.  
- **ranging**: Модуль сортировки участников по совокупности критериев:
  - Количество сданных лабораторных.
  - Номер сдаваемой лабораторной.
  - Посещение предыдущего занятия.
  - Сравнение сдаваемой и текущей лабораторной.
- **manualInput**: Модуль для ручного ввода данных.  
- **app**: Реализация меню приложения.  
- **auth_utils**: Обработка получения токена.  
- **cli**: Функции для работы с консолью.

## Тестирование
- Проверена корректная работа новой логики начисления/снятия баллов. 
### Результаты тестов
- Корректное выполнение всех функций.  
- Работа с большими объёмами данных.  
- Полная совместимость с Python 3.10+.

---

# Лицензия

Этот проект распространяется под лицензией **Apache License 2.0**.  
Подробнее можно ознакомиться с лицензией по следующей ссылке: [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0).
